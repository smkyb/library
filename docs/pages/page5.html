<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>smkyb's library</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.5.1/github-markdown.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
<style>
    html { background: repeating-linear-gradient(-45deg, rgb(245, 245, 245), 40px, rgb(255, 255, 255) 40px, rgb(255, 255, 255) 70px); }
    body { margin: 60px; margin-top: 60px; min-height: 100vh; font-family:'Noto Sans JP', Arial, sans-serif; font-size:large; }
    .markdown-body { box-sizing: border-box; max-width: 900px; margin: 0 auto; background: #ffffff56; backdrop-filter: blur(3px); color: black; padding: 40px; }
    .markdown-body pre { padding: 16px; overflow: auto; }
    .button_sq button       { display: flex; font-size: 22px; flex-direction: column; gap: 20px; margin-bottom: 10px; padding: 10px; padding-left: 30px; padding-right: 30px; background-color: rgb(89, 158, 157); color: white; border: none; cursor: pointer; text-align: center; transition: 0.5s; }
    .button_sq button:hover { display: flex; font-size: 22px; flex-direction: column; gap: 20px; margin-bottom: 10px; padding: 10px; padding-left: 90px; padding-right: 90px; background-color: rgb(0, 67, 67);    color: white; border: none; cursor: pointer; text-align: center; transition: 0.5s; }
    #button_copy { display: flex; font-size: 14px; }
    #button_copy_oneline { display: flex; font-size: 14px; }
    #status_bar { display: flex; justify-content: center; position: fixed; height: 70px; width:100%; top: 0px; left: 0px; background-color: rgba(255, 255, 255, 0.258);  backdrop-filter: blur(20px); font-family: sans-serif; font-size: 20px; font-weight: bolder; align-content: center; color: white; z-index: 998244353; }
    #status_bar a { margin: 20px; text-decoration: none; color: rgb(63, 97, 144); }
</style>
</head>
<body>
<div id="status_bar">
    <a href="/library/index.html">home</a>
    <a href="/library/about">about</a>
</div>
<article id="md_content" class="markdown-body">
# fastset

集合の要素の追加、削除、存在確認、および指定された値以上の最小の要素の探索を効率的に行うためのデータ構造です。

## コンストラクタ

```cpp
fastset(int _n);
```

*   `_n`: 集合に格納される可能性のある要素の最大値（ただし、実際にはこれより大きい値も格納可能ですが、内部的なサイズ決定に影響します）。

*   **制約**: `_n`は非負整数である必要があります。

*   **計算量**: O(1)

## insert

```cpp
void insert(int x);
```

*   `x`: 集合に追加する要素。

*   **制約**: `x`は非負整数である必要があります。

*   **計算量**: O(1)

## erase

```cpp
void erase(int x);
```

*   `x`: 集合から削除する要素。

*   **制約**: `x`は非負整数である必要があります。

*   **計算量**: O(1)

## count

```cpp
bool count(int x) const;
```

*   `x`: 集合に存在するか確認したい要素。

*   **返り値**: `x`が集合に含まれている場合は `true`、そうでない場合は `false` を返します。

*   **制約**: `x`は非負整数である必要があります。

*   **計算量**: O(1)

## lower_bound

```cpp
int lower_bound(int x);
```

*   `x`: 探索の開始値。

*   **返り値**: 集合内で `x` 以上の最小の要素を返します。もしそのような要素が存在しない場合は `-1` を返します。

*   **制約**: `x`は非負整数である必要があります。

*   **計算量**: O(1)

## less_bound

```cpp
int less_bound(int x);
```

*   `x`: 探索の開始値。

*   **返り値**: 集合内で `x` より小さい最大の要素を返します。もしそのような要素が存在しない場合は `-1` を返します。

*   **制約**: `x`は非負整数である必要があります。

*   **計算量**: O(1)</article>

<button id="button_copy" data-copy="struct fastset{
    using ull = unsigned long long;
    using uint = unsigned;
    
    int siz;
    vector&lt;ull&gt; node;
    
    fastset(int _n){
        int n = 1;
        while((n&lt;&lt;6) &lt; _n) n &lt;&lt;= 6;
        siz = (n+1)/63;
        node.resize((n+1)/63 + (_n+63)/64);
    }
    
    void insert(int x){
        uint idx = siz + (x/64);
        x &amp;= 63;
        while(true){
            if((node[idx]&gt;&gt;x) &amp; 1ull) return;
            node[idx] |= (1ull&lt;&lt;x);
            if(idx == 0) return;
            idx--;
            x = idx &amp; 63;
            idx /= 64;
        }
    }
    
    void erase(int x){
        int idx = siz + (x/64);
        x &amp;= 63;
        while(true){
            node[idx] &amp;= ~(1ull&lt;&lt;x);
            if(idx == 0 || node[idx]) return;
            idx--;
            x = idx &amp; 63;
            idx /= 64;
        }
    }
    
    bool count(int x) const {
        return (node[siz+x/64]&gt;&gt;(x&amp;63u))&amp;1;
    }
    
    int lower_bound(int x){
        if(count(x)) return x;
        int idx = siz + (x/64);
        x &amp;= 63;
        while(true){
            if(node[idx] &amp; ~(((1ull&lt;&lt;x)&lt;&lt;1) - 1ull)){
                x = __builtin_ctzll(node[idx] &amp; ~(((1ull&lt;&lt;x)&lt;&lt;1) - 1ull));
                if(idx &gt;= siz) return (idx-siz)*64+x;
                break;
            }
            if(idx == 0) return -1;
            idx--;
            x = idx &amp; 63;
            idx /= 64;
        }
        
        idx = idx*64 + x+1;
        while(idx &lt; siz) idx = idx*64 + __builtin_ctzll(node[idx])+1;
        return (idx-siz)*64 + __builtin_ctzll(node[idx]);
    }
    
    int less_bound(int x){
        if(count(x)) return x;
        int idx = siz + (x/64);
        x &amp;= 63;
        while(true){
            if(node[idx] &amp; ((1ull&lt;&lt;x) - 1ull)){
                x = 63 - __builtin_clzll(node[idx] &amp; ((1ull&lt;&lt;x) - 1ull));
                if(idx &gt;= siz) return (idx-siz)*64+x;
                break;
            }
            if(idx == 0) return -1;
            idx--;
            x = idx &amp; 63;
            idx /= 64;
        }
        
        idx = idx*64 + x+1;
        while(idx &lt; siz) idx = idx*64 + 64 - __builtin_clzll(node[idx]);
        return (idx-siz)*64 + 63 - __builtin_clzll(node[idx]);
    }
};">copy</button>
<button id="button_copy_oneline" data-copy="struct fastset{ using ull = unsigned long long; using uint = unsigned; int siz; vector&lt;ull&gt; node; fastset(int _n){ int n = 1; while((n&lt;&lt;6) &lt; _n) n &lt;&lt;= 6; siz = (n+1)/63; node.resize((n+1)/63 + (_n+63)/64); } void insert(int x){ uint idx = siz + (x/64); x &amp;= 63; while(true){ if((node[idx]&gt;&gt;x) &amp; 1ull) return; node[idx] |= (1ull&lt;&lt;x); if(idx == 0) return; idx--; x = idx &amp; 63; idx /= 64; } } void erase(int x){ int idx = siz + (x/64); x &amp;= 63; while(true){ node[idx] &amp;= ~(1ull&lt;&lt;x); if(idx == 0 || node[idx]) return; idx--; x = idx &amp; 63; idx /= 64; } } bool count(int x) const { return (node[siz+x/64]&gt;&gt;(x&amp;63u))&amp;1; } int lower_bound(int x){ if(count(x)) return x; int idx = siz + (x/64); x &amp;= 63; while(true){ if(node[idx] &amp; ~(((1ull&lt;&lt;x)&lt;&lt;1) - 1ull)){ x = __builtin_ctzll(node[idx] &amp; ~(((1ull&lt;&lt;x)&lt;&lt;1) - 1ull)); if(idx &gt;= siz) return (idx-siz)*64+x; break; } if(idx == 0) return -1; idx--; x = idx &amp; 63; idx /= 64; } idx = idx*64 + x+1; while(idx &lt; siz) idx = idx*64 + __builtin_ctzll(node[idx])+1; return (idx-siz)*64 + __builtin_ctzll(node[idx]); } int less_bound(int x){ if(count(x)) return x; int idx = siz + (x/64); x &amp;= 63; while(true){ if(node[idx] &amp; ((1ull&lt;&lt;x) - 1ull)){ x = 63 - __builtin_clzll(node[idx] &amp; ((1ull&lt;&lt;x) - 1ull)); if(idx &gt;= siz) return (idx-siz)*64+x; break; } if(idx == 0) return -1; idx--; x = idx &amp; 63; idx /= 64; } idx = idx*64 + x+1; while(idx &lt; siz) idx = idx*64 + 64 - __builtin_clzll(node[idx]); return (idx-siz)*64 + 63 - __builtin_clzll(node[idx]); } };">copy_oneline</button>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
    marked.setOptions({ gfm: true, breaks: true, headerIds: true, mangle: false, highlight: (code, lang) => { if (lang && hljs.getLanguage(lang)) { return hljs.highlight(code, { language: lang }).value; } return hljs.highlightAuto(code).value; } });
    const mdContent = document.getElementById("md_content");
    if(mdContent) mdContent.innerHTML = marked.parse(mdContent.textContent);
    
    const copyButton = document.getElementById("button_copy")
    if(copyButton){
        copyButton.addEventListener("click", () => {
            const text = copyButton.dataset.copy;
            navigator.clipboard.writeText(text);
        })
    }
    const copyButtonOneline = document.getElementById("button_copy_oneline")
    if(copyButtonOneline){
        copyButtonOneline.addEventListener("click", () => {
            const text = copyButtonOneline.dataset.copy;
            navigator.clipboard.writeText(text);
        })
    }
</script>
</body>
</html>